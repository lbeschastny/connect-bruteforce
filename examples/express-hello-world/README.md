Based on https://github.com/visionmedia/express/examples/auth
